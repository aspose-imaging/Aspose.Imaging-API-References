---
title: GetMissedFonts
second_title: Справочник по Aspose.Imaging for .NET API
description: Возвращает список шрифтов которые использовались внутри метафайла но не были найдены.
type: docs
weight: 30
url: /ru/net/aspose.imaging.fileformats.emf/metaimage/getmissedfonts/
---
## MetaImage.GetMissedFonts method

Возвращает список шрифтов, которые использовались внутри метафайла, но не были найдены.

```csharp
public string[] GetMissedFonts()
```

### Возвращаемое значение

Список шрифтов

### Примеры

В следующем примере показано, как распечатать информацию об используемых и пропущенных шрифтах в изображениях WMF/EMF.

```csharp
[C#]

string dir = "c:\\aspose.imaging\\net\\issues\\3544";

 // Сделать все шрифты недоступными
string[] fontDirectories = Aspose.Imaging.FontSettings.GetFontsFolders();
Aspose.Imaging.FontSettings.SetFontsFolder("empty");
string[] files = new string[]
{
    "TestWmfText.wmf",
    "TestEmfFonts.emf",
    "TestEmfPlusFonts.emf",
};

try
{
    foreach (string file in files)
    {
        System.Console.WriteLine("========== {0} ==========", file);
        using (Aspose.Imaging.FileFormats.Emf.MetaImage image = (Aspose.Imaging.FileFormats.Emf.MetaImage)Aspose.Imaging.Image.Load(System.IO.Path.Combine(dir, file)))
        {
            string[] used = image.GetUsedFonts();
            foreach (string it in used)
            {
                System.Console.WriteLine("Used font: " + it);
            }

            string[] missed = image.GetMissedFonts();
            foreach (string it in missed)
            {
                System.Console.WriteLine("Missed font: " + it);
            }

            int ui = 0, mi = 0;
            foreach (string it in used)
            {
                if (it.Contains("Times"))
                {
                    ui++;
                    continue;
                }

                if (used[ui] != missed[mi])
                {
                    throw new System.Exception("Font lists must be equal!");
                }

                ui++; mi++;
            }
        }
    }
}
finally
{
    Aspose.Imaging.FontSettings.SetFontsFolders(fontDirectories, true);
}

 // Журнал STDOUT может выглядеть так: 
 //========== TestWmfText.wmf ==========
 //Используемый шрифт: Garamond
 //Используемый шрифт: Arial
 //Используемый шрифт: Bookman Old Style
 //Используемый шрифт: Comic Sans MS
 //Используемый шрифт: Courier
 //Используемый шрифт: Courier New
 //Используемый шрифт: Impact
 //Используемый шрифт: Modern
//Используемый шрифт: MS Sans Serif
 //Используемый шрифт: MS Serif
 //Используемый шрифт: Small Fonts
 //Используемый шрифт: Symbol
 //Используемый шрифт: Tahoma
 //Используемый шрифт: Times New Roman
 //Используемый шрифт: Verdana
 //Используемый шрифт: Wingdings
 // Пропущенный шрифт: Garamond
 // Отсутствует шрифт: Arial
 // Отсутствует шрифт: Bookman Old Style
 // Отсутствует шрифт: Comic Sans MS
 // Отсутствует шрифт: Courier
 //Отсутствует шрифт: Courier New
 //Пропущенный шрифт: Impact
 // Отсутствует шрифт: Modern
 // Отсутствует шрифт: MS Sans Serif
 // Отсутствует шрифт: MS Serif
 //Пропущенный шрифт: Small Fonts
 //Пропущенный шрифт: Symbol
 // Пропущенный шрифт: Tahoma
 // Отсутствует шрифт: Verdana
 // Отсутствует шрифт: Wingdings
 //========== TestEmfFonts.emf ==========
 //Используемый шрифт: Arial
 //Используемый шрифт: Verdana
 //Используемый шрифт: Times New Roman
 //Используемый шрифт: Symbol
 // Отсутствует шрифт: Arial
 // Отсутствует шрифт: Verdana
 //Пропущенный шрифт: Symbol
 //========== TestEmfPlusFonts.emf ==========
 //Используемый шрифт: MICROSOFT SANS SERIF
// Пропущенный шрифт: MICROSOFT SANS SERIF
```

### Смотрите также

* class [MetaImage](../../metaimage)
* пространство имен [Aspose.Imaging.FileFormats.Emf](../../metaimage)
* сборка [Aspose.Imaging](../../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Imaging.dll -->
